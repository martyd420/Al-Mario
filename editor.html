 
<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>Level Editor</title>
  <style>
    body { font-family: sans-serif; }
    #grid { display: grid; gap: 1px; background: #aaa; }
    .cell {
      width: 20px; height: 20px;
      text-align: center;
      line-height: 20px;
      font-size: 12px;
      background: #eee;
      cursor: pointer;
      position: relative;
    }
    .cell.wall { background: #444; }
    .cell.player::after { content: "P"; color: blue; font-weight: bold; }
    .cell.enemy::after { content: "E"; color: red; }
    .cell.coin::after { content: "C"; color: darkorange; }
    .cell.goal::after { content: "G"; color: green; }

    .toolbar button { margin: 3px; }
    textarea { width: 100%; height: 120px; margin-top: 10px; }
  </style>
</head>
<body>

<h3>Vizuální editor levelu</h3>

<div class="toolbar">
  <button onclick="setTool('wall')">Zed</button>
  <button onclick="setTool('empty')">Prazdno</button>
  <button onclick="setTool('player')">Hráč</button>
  <button onclick="setTool('enemy')">Nepřítel</button>
  <button onclick="setTool('coin')">Mince</button>
  <button onclick="setTool('goal')">Cíl</button>
  <button onclick="addColumn()">+ Sloupec</button>
  <button onclick="removeColumn()">− Sloupec</button>
  <button onclick="addRow()">+ Řádek</button>
  <button onclick="removeRow()">− Řádek</button>
  <button onclick="exportLevel()">Export</button>
</div>

<div id="grid"></div>

<textarea id="output" readonly></textarea>

<script>
let width = 32;
let height = 8;
let tiles = Array.from({ length: height }, () => Array(width).fill(0));
let playerStart = null;
let enemies = [];
let coins = [];
let goal = null;

let currentTool = 'wall';

const grid = document.getElementById('grid');

function renderGrid() {
  grid.innerHTML = '';
  grid.style.gridTemplateColumns = `repeat(${width}, 20px)`;

  for (let y = 0; y < height; y++) {
    for (let x = 0; x < width; x++) {
      const div = document.createElement('div');
      div.className = 'cell';
      div.dataset.x = x;
      div.dataset.y = y;
      if (tiles[y][x] === 1) div.classList.add('wall');
      if (playerStart && playerStart.x === x && playerStart.y === y) div.classList.add('player');
      if (goal && goal.x === x && goal.y === y) div.classList.add('goal');
      if (coins.some(c => c.x === x && c.y === y)) div.classList.add('coin');
      if (enemies.some(e => e.x === x && e.y === y)) div.classList.add('enemy');
      div.onclick = handleClick;
      grid.appendChild(div);
    }
  }
}

function handleClick(e) {
  const x = parseInt(e.target.dataset.x);
  const y = parseInt(e.target.dataset.y);

  if (currentTool === 'wall') tiles[y][x] = 1;
  else if (currentTool === 'empty') tiles[y][x] = 0;
  else if (currentTool === 'player') playerStart = { x, y };
  else if (currentTool === 'goal') goal = { x, y };
  else if (currentTool === 'enemy') enemies.push({ x, y });
  else if (currentTool === 'coin') coins.push({ x, y });

  renderGrid();
}

function setTool(tool) {
  currentTool = tool;
}

function addColumn() {
  width++;
  tiles.forEach(row => row.push(0));
  renderGrid();
}

function removeColumn() {
  if (width <= 1) return;
  width--;
  tiles.forEach(row => row.pop());
  renderGrid();
}

function addRow() {
  height++;
  tiles.push(Array(width).fill(0));
  renderGrid();
}

function removeRow() {
  if (height <= 1) return;
  height--;
  tiles.pop();
  renderGrid();
}

function exportLevel() {
  const scale = 48; // scaling to match original coordinate system
  const level = {
    width,
    height,
    tiles,
    playerStart: playerStart ? { x: playerStart.x * scale, y: playerStart.y * scale } : null,
    enemies: enemies.map(e => ({ x: e.x * scale, y: e.y * scale })),
    coins: coins.map(c => ({ x: c.x * scale, y: c.y * scale })),
    goal: goal ? { x: goal.x, y: goal.y } : null
  };
  document.getElementById('output').value = JSON.stringify(level, null, 2);
}

renderGrid();
</script>

</body>
</html>
